<Window x:Class="Noten.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Noten" Height="700" Width="1100" MinHeight="560" MinWidth="880"
        WindowStyle="SingleBorderWindow"
        Background="#121316"
        Foreground="#EDEEF3">
    <Border Padding="12" CornerRadius="12" Background="#191B20">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Background="Transparent" MouseEnter="TopHoverZone_OnMouseEnter" MouseLeave="TopHoverZone_OnMouseLeave">
                <DockPanel LastChildFill="False">
                    <ComboBox Width="220" ItemsSource="{Binding Projects}" SelectedItem="{Binding ActiveProject}" DisplayMemberPath="Name" Margin="0,0,8,0"/>
                    <Button Content="+" Width="30" Command="{Binding AddProjectCommand}"/>
                    <Button Content="Rename" Margin="8,0,0,0" Click="RenameProject_Click"/>
                    <Button Content="Duplicate" Margin="8,0,0,0" Command="{Binding DuplicateProjectCommand}"/>
                    <Button Content="Delete" Margin="8,0,0,0" Click="DeleteProject_Click"/>
                    <Button Content="Export" Margin="8,0,0,0" Click="ExportProject_Click"/>
                    <Button Content="Import" Margin="8,0,0,0" Click="ImportProject_Click"/>
                    <Button Content="Settings" Margin="8,0,0,0" Click="Settings_Click"/>
                </DockPanel>
            </Border>

            <DockPanel Grid.Row="1" Margin="0,8,0,6">
                <TextBox Width="280"
                         Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                         VerticalContentAlignment="Center"
                         ToolTip="Search notes, lists, and schedule in current project"/>
                <TextBlock Margin="8,0,0,0" VerticalAlignment="Center" Foreground="#B0B3BE" Text="Project search"/>
            </DockPanel>

            <Border x:Name="SearchResultsHost"
                    Grid.Row="2"
                    Background="#20242C"
                    BorderBrush="#2E3440"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="8"
                    Margin="0,0,0,8"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock Text="Search Results" FontWeight="SemiBold" Margin="0,0,0,6"/>
                    <ListBox ItemsSource="{Binding SearchResults}" MaxHeight="160">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Margin="0,2,0,4">
                                    <TextBlock FontWeight="SemiBold" Text="{Binding Title}"/>
                                    <TextBlock FontSize="11" Foreground="#BCC3D4" Text="{Binding Snippet}" TextWrapping="Wrap"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </Border>

            <Grid Grid.Row="3">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Border x:Name="TabRevealHost" Grid.Row="0" Opacity="0.12" Background="#282C34" CornerRadius="8" Padding="4" Margin="0,0,0,8">
                    <TabControl x:Name="MainTabs" KeyboardNavigation.TabNavigation="Cycle">
                        <TabItem Header="Notes"/>
                        <TabItem Header="Lists"/>
                        <TabItem Header="Schedule"/>
                    </TabControl>
                </Border>

                <Grid Grid.Row="1">
                    <TabControl SelectedIndex="{Binding ElementName=MainTabs, Path=SelectedIndex}">
                        <TabItem>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <ToolBarTray>
                                    <ToolBar>
                                        <ComboBox Width="100" SelectedIndex="0">
                                            <ComboBoxItem>Normal</ComboBoxItem>
                                            <ComboBoxItem>Heading 1</ComboBoxItem>
                                            <ComboBoxItem>Heading 2</ComboBoxItem>
                                        </ComboBox>
                                        <Separator/>
                                        <Button Command="EditingCommands.ToggleBold" Content="B" FontWeight="Bold"/>
                                        <Button Command="EditingCommands.ToggleItalic" Content="I" FontStyle="Italic"/>
                                        <Button Command="EditingCommands.ToggleUnderline" Content="U"/>
                                        <Separator/>
                                        <Button Command="EditingCommands.ToggleBullets" Content="â€¢ List"/>
                                        <Button Command="EditingCommands.ToggleNumbering" Content="1. List"/>
                                        <Separator/>
                                        <Button Click="InsertLink_Click" Content="Link"/>
                                        <Button Command="ApplicationCommands.Undo" Content="Undo"/>
                                        <Button Command="ApplicationCommands.Redo" Content="Redo"/>
                                    </ToolBar>
                                </ToolBarTray>
                                <RichTextBox x:Name="NotesEditor" Grid.Row="1" AcceptsTab="True" VerticalScrollBarVisibility="Auto"
                                             TextChanged="NotesEditor_OnTextChanged" Margin="0,8,0,0"/>
                            </Grid>
                        </TabItem>
                        <TabItem>
                            <Grid>
                                <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                                <Button Content="Add List" Width="100" HorizontalAlignment="Left" Command="{Binding AddListCommand}"/>
                                <ScrollViewer Grid.Row="1" Margin="0,8,0,0">
                                    <ItemsControl ItemsSource="{Binding ActiveProject.Lists}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#23262D" CornerRadius="8" Margin="0,0,0,8" Padding="8">
                                                    <StackPanel>
                                                        <DockPanel>
                                                            <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" FontWeight="SemiBold" Width="280" LostFocus="AutosaveField_OnLostFocus"/>
                                                            <Button Content="+ Item" Margin="8,0,0,0"
                                                                    Command="{Binding DataContext.AddTodoItemCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                    CommandParameter="{Binding}"/>
                                                        </DockPanel>
                                                        <ItemsControl ItemsSource="{Binding Items}">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                    <DockPanel Margin="0,4,0,0">
                                                                        <CheckBox IsChecked="{Binding IsCompleted}" Margin="0,0,6,0" Checked="AutosaveField_OnValueChanged" Unchecked="AutosaveField_OnValueChanged"/>
                                                                        <TextBox Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}" MinWidth="280" LostFocus="AutosaveField_OnLostFocus"/>
                                                                    </DockPanel>
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                        </ItemsControl>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Grid>
                        </TabItem>
                        <TabItem>
                            <Grid>
                                <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                                <DockPanel>
                                    <Button Content="Add Entry" Width="100" Command="{Binding AddScheduleCommand}"/>
                                    <ComboBox x:Name="ScheduleFilterCombo"
                                              Width="140"
                                              Margin="8,0,0,0"
                                              SelectionChanged="ScheduleFilterCombo_OnSelectionChanged"
                                              SelectedIndex="1">
                                        <ComboBoxItem Tag="Today">Today</ComboBoxItem>
                                        <ComboBoxItem Tag="Upcoming">Upcoming</ComboBoxItem>
                                        <ComboBoxItem Tag="All">All</ComboBoxItem>
                                    </ComboBox>
                                </DockPanel>
                                <DataGrid Grid.Row="1" AutoGenerateColumns="False" ItemsSource="{Binding VisibleScheduleEntries}" Margin="0,8,0,0" RowEditEnding="ScheduleGrid_OnRowEditEnding">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Title" Binding="{Binding Title, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                                        <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat=d}" Width="120"/>
                                        <DataGridTextColumn Header="Start" Binding="{Binding StartTime}" Width="100"/>
                                        <DataGridTextColumn Header="End" Binding="{Binding EndTime}" Width="100"/>
                                        <DataGridTextColumn Header="Notes" Binding="{Binding Notes, UpdateSourceTrigger=PropertyChanged}" Width="2*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
